<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>图片淡入淡出</title>
    <style type="text/css">
        div{
            width:250px;
            height: 250px;
            background-color: red;
            margin: 10px;
            float: left;
            opacity: 0.3;
            /* filter:alpha(opacity=30); 兼容IE*/
        }
        div img{
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>
    <script type="text/javascript">
        // window.onload = function(){
        //     var oDiv = document.getElementsByTagName('div');
        //     for(var i = 0; i < oDiv.length; i++){
        //         //所有的多物体运动、所有东西都不能存在共用的情况
        //         oDiv[i].style.opacity = 0.3;	//设置一个淡入淡出的变量
        //         oDiv[i].timer = null;
        //         oDiv[i].onmouseover=function(){
        //             startMove(this,1);
        //         };
        //         oDiv[i].onmouseout=function(){
        //             startMove(this,0.3);
        //         };
        //     }
        // }
        // function startMove(obj,nTarget){
        //     //关闭自身物体的定时器
        //     clearInterval(obj.timer);
        //     //开启当前点中物体的定时器
        //     obj.timer=setInterval(function(){
        //            var speed = (nTarget - obj.style['opacity'])/6;
        //            speed = speed > 0 ? Math.ceil(speed*1000000)/1000000 : Math.floor(speed*1000000)/1000000;
        //            var opacityTemp = obj.style['opacity'];//不能直接用obj.style['opacity'],会直接改变它的值
        //            if (opacityTemp == nTarget) {
        //            	    clearInterval(obj.timer);
        //            }else{      	 
        //                 obj.style['opacity'] = add(opacityTemp,speed);
        //            }

        //     },30)
        // }
        // //定义一个加法函数
        // function add(){
        //     var args = arguments,//获取所有的参数
        //         lens = args.length,//获取参数的长度
        //         d = 0,//定义小数位的初始长度，默认为整数，即小数位为0
        //         sum = 0;//定义sum来接收所有数据的和       
        //     //循环所有的参数
        //     for(var keys in args){//遍历所有的参数
        //         //把数字转为字符串
        //         var str = "" + args[keys];
        //         if(str.indexOf(".")!=-1){//判断数字是否为小数
        //             //获取小数位的长度
        //             var temp = str.split(".")[1].length;
        //             //比较此数的小数位与原小数位的长度，取小数位较长的存储到d中
        //             d = d < temp ? temp : d;
        //         }
        //     }
        //     //计算需要乘的数值
        //     var m = Math.pow(10,d);
        //     //遍历所有参数并相加
        //     for(var key in args){
        //         sum +=  Math.round(args[key]*m);
        //     }
        //     //返回结果
        //     return sum/m;
        // }
        window.onload = function(){
       	   var aDiv = document.getElementsByTagName('div');
           for(var i=0;i<aDiv.length;i++){
              //所有的多物体运动、所有东西都不能存在共用的情况
              aDiv[i].timer = null;
              aDiv[i].alpha = 30;	//设置一个淡入淡出的变量
           	  aDiv[i].onmouseover=function(){
           	  	startMove(this,100);
           	  };
        	  aDiv[i].onmouseout=function(){
           	  	startMove(this,30);
           	  };
           };
       };

		 //var alpha=30; //设置一个淡入淡出的变量

        function startMove(obj,iTarget){
            //关闭自身物体的定时器
            clearInterval(obj.timer);
            //开启当前点中物体的定时器
            obj.timer=setInterval(function(){
                   //定义变量，计算一下速度
                   //除6让运动缓冲
                   var speed = (iTarget-obj.alpha)/6;
                   spped=speed>0?Math.ceil(speed):Math.floor(speed);
                   if (obj.alpha == iTarget) {
                   	    clearInterval(obj.timer);
                   }else{
                   	    obj.alpha += speed;
                   	    obj.style.opacity = obj.alpha/100;
                   }

            },30)
         }
    </script>
</head>
<body>
    <div><img src="img/avatar_1.jpg"></div>
	<div><img src="img/avatar_2.jpg"></div>
	<div><img src="img/avatar_3.jpg"></div>
	<div><img src="img/avatar_4.jpg"></div>
</body>
</html>